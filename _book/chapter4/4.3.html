
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>4.3监控系统管理 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="4.4.html" />
    
    
    <link rel="prev" href="4.2.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="4.0.html">
            
                <a href="4.0.html">
            
                    
                    4 监控
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="4.1.html">
            
                <a href="4.1.html">
            
                    
                    4.1理想的监控策略
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="4.2.html">
            
                <a href="4.2.html">
            
                    
                    4.2监控数据来源
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.3" data-path="4.3.html">
            
                <a href="4.3.html">
            
                    
                    4.3监控系统管理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="4.4.html">
            
                <a href="4.4.html">
            
                    
                    4.4度量指标
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="4.5.html">
            
                <a href="4.5.html">
            
                    
                    4.5报警逻辑测试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="4.6.html">
            
                <a href="4.6.html">
            
                    
                    4.6总结
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >4.3监控系统管理</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="managing-your-monitoring-system">Managing Your Monitoring System</h2>
<p>Your monitoring system is as important as any other service you run. As such, it should be treated with the appropriate level of care and attention.</p>
<h3 id="treat-your-configuration-as-code">Treat Your Configuration as Code</h3>
<p>Treating system configuration as code and storing it in the revision control system are common practices that provide some obvious benefits: change history, links from specific changes to your task tracking system, easier rollbacks and linting checks,1 and enforced code review procedures.</p>
<p>We strongly recommend also treating monitoring configuration as code (for more on configuration, see Chapter 14). A monitoring system that supports intent-based configuration is preferable to systems that only provide web UIs or CRUD-style APIs. This configuration approach is standard for many open source binaries that only read a configuration file. Some third-party solutions like grafanalib enable this approach for components that are traditionally configured with a UI.</p>
<h3 id="encourage-consistency">Encourage Consistency</h3>
<p>Large companies with multiple engineering teams who use monitoring need to strike a fine balance: a centralized approach provides consistency, but on the other hand, individual teams may want full control over the design of their configuration.</p>
<p>The right solution depends on your organization. Google&#x2019;s approach has evolved over time toward convergence on a single framework run centrally as a service. This solution works well for us for a few reasons. A single framework enables engineers to ramp up faster when they switch teams, and makes collaboration during debugging easier. We also have a centralized dashboarding service, where each team&#x2019;s dash&#x2010; boards are discoverable and accessible. If you easily understand another team&#x2019;s dash&#x2010; board, you can debug both your issues and theirs more quickly.</p>
<p>If possible, make basic monitoring coverage effortless. If all your services2 export a consistent set of basic metrics, you can automatically collect those metrics across your entire organization and provide a consistent set of dashboards. This approach means that any new component you launch automatically has basic monitoring. Many teams across your company&#x2014;even nonengineering teams&#x2014;can use this moni&#x2010; toring data.</p>
<h3 id="prefer-loose-coupling">Prefer Loose Coupling</h3>
<p>Business requirements change, and your production system will look different a year from now. Similarly, your monitoring system needs to evolve over time as the serv&#x2010; ices it monitors evolve through different patterns of failure.</p>
<p>We recommend keeping the components of your monitoring system loosely coupled. You should have stable interfaces for configuring each component and passing moni&#x2010; toring data. Separate components should be in charge of collecting, storing, alerting, and visualizing your monitoring. Stable interfaces make it easier to swap out any given component for a better alternative.</p>
<p>Splitting functionality into individual components is becoming popular in the open source world. A decade ago, monitoring systems like Zabbix combined all functions into a single component. Modern design usually involves separating collection and rule evaluation (with a solution like Prometheus server), long-term time series stor&#x2010; age (InfluxDB), alert aggregation (Alertmanager), and dashboarding (Grafana).</p>
<p>As of this writing, there are at least two popular open standards for instrumenting your software and exposing metrics:</p>
<ul>
<li><p>statsd</p>
<p>The metric aggregation daemon initially written by Etsy and now ported to a majority of programming languages.</p>
</li>
<li><p>Prometheus</p>
<p>An open source monitoring solution with a flexible data model, support for met&#x2010; ric labels, and robust histogram functionality. Other systems are now adopting the Prometheus format, and it is being standardized as OpenMetrics.</p>
</li>
</ul>
<p>A separate dashboarding system that can use multiple data sources provides a central and unified overview of your service. Google recently saw this benefit in practice: our legacy monitoring system (Borgmon3) combined dashboards in the same configura&#x2010; tion as alerting rules. While migrating to a new system (Monarch), we decided to move dashboarding into a separate service (Viceroy). Because Viceroy was not a component of Borgmon or Monarch, Monarch had fewer functional requirements. Since users could use Viceroy to display graphs based on data from both monitoring systems, they could gradually migrate from Borgmon to Monarch.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="4.2.html" class="navigation navigation-prev " aria-label="Previous page: 4.2监控数据来源">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="4.4.html" class="navigation navigation-next " aria-label="Next page: 4.4度量指标">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"4.3监控系统管理","level":"1.2.3","depth":2,"next":{"title":"4.4度量指标","level":"1.2.4","depth":2,"path":"chapter4/4.4.md","ref":"chapter4/4.4.md","articles":[]},"previous":{"title":"4.2监控数据来源","level":"1.2.2","depth":2,"path":"chapter4/4.2.md","ref":"chapter4/4.2.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"chapter4/4.3.md","mtime":"2018-07-30T03:15:53.675Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-07-30T02:11:36.871Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

